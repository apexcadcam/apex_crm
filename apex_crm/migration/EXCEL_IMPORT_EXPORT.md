# استيراد وتصدير Apex Contacts من/إلى Excel

## الميزات الجديدة

تم إضافة دعم كامل لاستيراد وتصدير بيانات Apex Contacts من/إلى Excel مباشرة من واجهة ERPNext.

## كيفية الاستخدام

### 1. تصدير البيانات إلى Excel

1. افتح قائمة **Lead** من القائمة الرئيسية
2. اضغط على زر **"Export Apex Contacts"** في شريط الأدوات
3. سيتم تحميل ملف Excel تلقائياً يحتوي على جميع بيانات Apex Contacts

**تنسيق ملف Excel المصدر:**
- **Lead ID**: معرف Lead
- **Lead Name**: اسم Lead
- **Type**: نوع الاتصال (Mobile, Phone, Email, WhatsApp, Facebook, etc.)
- **Country Code**: رمز الدولة (مثل +20)
- **Value**: قيمة الاتصال (رقم الهاتف، البريد الإلكتروني، الرابط، etc.)
- **Is Primary**: هل هو الحقل الأساسي (1 = نعم، 0 = لا)
- **Notes**: ملاحظات إضافية

### 2. استيراد البيانات من Excel

1. افتح قائمة **Lead** من القائمة الرئيسية
2. اضغط على زر **"Import Apex Contacts"** في شريط الأدوات
3. اختر ملف Excel من جهازك
4. انتظر حتى يكتمل الاستيراد
5. ستظهر رسالة بنتيجة الاستيراد (عدد Leads المستوردة، عدد الأخطاء إن وجدت)

**متطلبات ملف Excel:**
- يجب أن يحتوي على الأعمدة التالية: **Lead ID**, **Type**, **Value**
- الأعمدة الأخرى (Country Code, Is Primary, Notes) اختيارية
- يجب أن يكون Lead ID موجوداً في النظام
- سيتم تخطي التكرارات تلقائياً

## ملاحظات مهمة

1. **أنواع الاتصال المتاحة:**
   - Mobile, Phone, Email, WhatsApp, Telegram
   - Website, Facebook, Instagram, LinkedIn
   - TikTok, Snapchat, X, Location, Other

2. **Country Code:**
   - يجب أن يكون بالتنسيق `+20` أو `+966`
   - يمكن تركه فارغاً للأنواع التي لا تحتاج رمز دولة (مثل Email, Website)

3. **Is Primary:**
   - استخدم `1` للحقل الأساسي
   - استخدم `0` للباقي

4. **التكرارات:**
   - Script الاستيراد يتخطى التكرارات تلقائياً
   - إذا كان نفس النوع والقيمة موجودين بالفعل، لن يتم إضافتهم مرة أخرى

## المتطلبات التقنية

- **pandas**: مكتبة Python لمعالجة البيانات
- **openpyxl**: مكتبة Python لقراءة/كتابة ملفات Excel

إذا لم تكن مثبتة، قم بتثبيتها باستخدام:
```bash
pip install pandas openpyxl
```

## الأخطاء الشائعة

1. **"Lead XXX غير موجود"**
   - تأكد من أن Lead ID صحيح وموجود في النظام

2. **"الأعمدة المطلوبة مفقودة"**
   - تأكد من وجود الأعمدة: Lead ID, Type, Value
   - يمكن أن تكون بأي حالة (uppercase/lowercase)

3. **"pandas غير مثبت"**
   - قم بتثبيت pandas و openpyxl كما هو موضح أعلاه

## الدعم

للمساعدة أو الإبلاغ عن مشاكل، يرجى التواصل مع فريق الدعم.





















